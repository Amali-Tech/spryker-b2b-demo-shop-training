{% extends template('widget') %}

{% define data = {
    quoteRequestOverviewCollection: _widget.quoteRequestOverviewCollection,
    cartForm: _widget.cartForm ?? null,
} %}

{% block requestList %}
    <ul class="col menu menu--inline">
        <li class="menu__item menu__item--has-children-dropdown">
            <a class="grid grid--center text-secondary" href="{{ path('agent/quote-request') }}" title="{{ 'quote_request_agent_widget.quote_request' | trans }}">
                {% include atom('icon') with {
                    class: 'col col-sm-12',
                    modifiers: ['big', 'message'],
                    data: {
                        name: 'message',
                    },
                } only %}
                <div class="col col--sm-12 text-center">{{ 'quote_request_agent_widget.quote_request' | trans }}</div>
            </a>
            <ul class="menu menu--wider text-left">
                {% if data.quoteRequestOverviewCollection.quoteRequests | length %}
                    {% for quoteRequest in data.quoteRequestOverviewCollection.quoteRequests %}
                        <li class="menu__item">
                            {% include molecule('quote-request-detail', 'QuoteRequestAgentWidget') with {
                                data: {
                                    quoteRequest: quoteRequest,
                                },
                            } only %}
                        </li>
                        <li class="menu__separator menu__separator--horizontal-line"></li>
                    {% endfor %}
                {% else %}
                    <li class="menu__item">
                        <span class="no-items no-quote-requests">
                            {{ 'quote_request_agent_widget.no_request_created' | trans }}
                        </span>
                    </li>
                {% endif %}

                <li class="menu__item">
                    <div class="grid grid--justify spacing-y spacing-y--inner">
                        <div class="col">
                            <a href="{{ path('agent/quote-request') }}" class="button button--hollow" title="{{ 'quote_request_agent_widget.view_all_requests' | trans }}">
                                {{ 'quote_request_agent_widget.view_all_requests' | trans }}
                            </a>
                        </div>
                        <div class="col">
                            <a href="{{ path('agent/quote-request/create') }}" class="button button--success" title="{{ 'quote_request_agent_widget.create_new_request' | trans }}">
                                {{ 'quote_request_agent_widget.create_new_request' | trans }}
                            </a>
                        </div>
                    </div>
                </li>
            </ul>
        </li>
    </ul>
{% endblock %}

{% block body %}
    {{ block('requestList') }}
    {% block activeRequest %}
        {% if data.quoteRequestOverviewCollection.currentQuoteRequest is not empty %}
            <div class="grid grid--middle box spacing--inner">
                <div class="col col--sm-12">
                    {% include molecule('quote-request-detail', 'QuoteRequestAgentWidget') with {
                        modifiers: ['small'],
                        data: {
                            quoteRequest: data.quoteRequestOverviewCollection.currentQuoteRequest,
                        },
                    } only %}
                    {% block activeRequestActions %}
                        {% include molecule('quote-request-cart-from', 'QuoteRequestAgentWidget') with {
                            data: {
                                quoteRequestReference: data.quoteRequestOverviewCollection.currentQuoteRequest.quoteRequestReference,
                                cartForm: data.cartForm,
                            },
                        } only %}
                    {% endblock %}
                </div>
            </div>
        {% endif %}
    {% endblock %}
{% endblock %}
